<%- include("partials/header") %>

<!-- View either all the details of an individual work order or view all work orders past and present -->
<body>
    <meta http-equiv="refresh" content="5"></meta>
    <h1>This is the Detailed Work Order Page</h1>
    <form action="filter_workOrders" action="/workorders" method="GET">
        <label>Filter Location</label>
        <select name="location" id="location">
            <option>All Locations</option>
            <% enclosures.forEach(function(location) { %>
                <option value="<%= location.location %>"><%= location.location %></option>
            <% }); %>
        </select>
    </form>
    <!-- This will pull all open work orders into a table -->
    <table class="workOrders">
        <legend>Work Order History</legend>
        <thead>
            <th>Order Number</th>
            <th>Zookeeper</th>
            <th>Location</th>
            <th>Species</th>
            <th>Task</th>
            <th>Supply Name</th>
            <th>Available Date</th>
            <th>Overdue Date</th>
            <th>Available</th>
            <th>Accepted</th>
            <th>Overdue</th>
            <th>Complete</th>
            <th>Edit</th>
            <th>Delete</th>
        </thead>
        <tbody>
            <% workOrders.forEach(function(ticket) { %>
                <tr>
                    <td> <%= ticket.work_order_id %> </td>
                    <td> <%= ticket.first_name + " " + ticket.last_name %> </td>
                    <% if (ticket.enclosure_id === null) { %>
                        <td>None</td>
                    <% } else { %>
                        <td><%= ticket.location %></td>
                    <% } %>
                    <% if (ticket.enclosure_id === null) { %>
                        <td>None</td>
                    <% } else { %>
                        <td><%= ticket.species %></td>
                    <% } %>
                    <td> <%= ticket.task_name %> </td>
                    <td> <%= ticket.supply_name %> </td>
                    <td> <%= ticket.available_time %> </td>
                    <td> <%= ticket.overdue_time %> </td>
                    <% if (ticket.available === 1) { %>
                        <td>YES</td>
                    <% } else { %>
                        <td>NO</td>
                    <% } %>
                    <% if (ticket.accepted_task === 1) { %>
                        <td>YES</td>
                    <% } else { %>
                        <td>NO</td>
                    <% } %>
                    <% if (ticket.overdue_status === 1) { %>
                        <td>YES</td>
                    <% } else { %>
                        <td>NO</td>
                    <% } %>
                    <% if (ticket.completed_task === 1) { %>
                        <td>YES</td>
                    <% } else { %>
                        <td>NO</td>
                    <% } %>
                    <td><form action="/workorders/edit/<%=ticket.work_order_id%>" method="GET">
                        <button type="submit">EDIT</button>
                        </form>
                    </td>
                    <td><form action="/workorders/delete/<%=ticket.work_order_id%>?_method=DELETE" method="POST">
                        <button type="submit">DELETE</button>
                        </form>
                    </td>
                </tr>
            <% }); %>
        </tbody>
    </table>
    <br>
    <button><a href="/">Return Home</a></button>

<%- include("partials/footer") %>