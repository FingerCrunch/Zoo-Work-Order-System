<%- include("partials/header") %>

<body>
    <h1> <!-- https://stackoverflow.com/questions/32540044/html-display-current-date/32540196 -->
        Ticketing System - Date: <script> document.write(new Date().toLocaleDateString()); </script> 
    </h1>
    <div>
        <h2>Current Employees On Shift</h2> <!-- Will use the On-Shift = True to fill this ordered list -->
        <ol>
            <!-- Creates a new <li> for each Zoo Keeper who's OnShift Status Value is 1 -->
            <% zookeepers.forEach(function(zookeeper) { %>
                <li> <%= zookeeper.first_name + " " + zookeeper.last_name %> </li>
            <% }); %>
        </ol>
        <!-- Pulls up all the information for all Zoo Keepers in the DB-->
        <button><a href="/zookeepers">View All Zoo Keepers</a></button>
    </div>
    <div>
        <!-- This will pull all open work orders into a table -->
        <table class="workOrders">
            <legend>Current Open Work Orders</legend>
            <thead>
                <th>work_order_id</th>
                <th>zookeeper_id</th>
                <th>enclosure_id</th>
                <th>task_name</th>
                <th>supply_id</th>
                <th>available</th>
                <th>available_time</th>
                <th>overdue_time</th>
                <th>overdue_status</th>
                <th>accepted task</th>
                <th>completed_task</th>
            </thead>
            <tbody>
                <% workOrders.forEach(function(ticket) { %>
                    <tr>
                        <td> <%= ticket.work_order_id %> </td>
                        <td> <%= ticket.zookeeper_id %> </td>
                        <td> <%= ticket.enclosure_id %> </td>
                        <td> <%= ticket.task_name %> </td>
                        <td> <%= ticket.supply_id %> </td>
                        <% if (ticket.available === 1) { %>
                            <td>YES</td>
                        <% } else { %>
                            <td>NO</td>
                        <% } %>
                        <td> <%= ticket.available_time %> </td>
                        <td> <%= ticket.overdue_time %> </td>
                        <% if (ticket.overdue_status === 1) { %>
                            <td>YES</td>
                        <% } else { %>
                            <td>NO</td>
                        <% } %>
                        <% if (ticket.accepted_task === 1) { %>
                            <td>YES</td>
                        <% } else { %>
                            <td>NO</td>
                        <% } %>
                        <% if (ticket.completed_task === 1) { %>
                            <td>YES</td>
                        <% } else { %>
                            <td>NO</td>
                        <% } %>
                    </tr>
                <% }); %>
                <tr>
                </tr>
            </tbody>
        </table>
        <button><a href="/workorders">View All Work Orders</a></button> <!-- View all including completed work orders -->
    </div>
    <div>
        <!-- This can be moved to a new page but I think it makes sense to submit straight from home screen -->
        <form id="addWorkOrder" action="/workorders" method="POST">
            <fieldset>
                <legend>Submit New Work Order</legend>
                <textarea name="task" id="task" cols="30" rows="2" required placeholder="Task Description"></textarea><br>
                <!-- I'm thinking we will hardcode the supplies or dynamically fill options from database -->
                <select name="supplies" id="supplies" multiple required>Supplies Needed
                    <option value="None">None</option>
                    <!-- Creates a new option for each supply in the Supplies Table -->
                    <% supplies.forEach(function(supply) { %>
                        <option value="<%= supply.supply_id %>"><%= supply.supply_name %></option>
                    <%}); %>    
                </select><br>
                <!-- Creates a new option for each enclosure in the Animal_Enclosures Table -->
                <select name="enclosure" required>
                    <% enclosures.forEach(function(enclosure) { %>
                        <option value="<%= enclosure.enclosure_id %>"><%= enclosure.species %></option>
                    <%}); %>   
                </select><br>
                <!-- Creates a new option for each Zoo Keeper who's OnShift Status is 1 -->
                <select name="zookeeper" required>
                    <% zookeepers.forEach(function(zookeeper) { %>
                        <option value="<%= zookeeper.zookeeper_id %>"><%= zookeeper.first_name + " " + zookeeper.last_name %></option>
                    <%}); %>    
                </select><br>
                <button>Create New Work Order</button>
            </fieldset> 
        </form>
    </div>
    <button><a href="/supplies">View All Supplies</a></button>

<%- include("partials/footer") %>